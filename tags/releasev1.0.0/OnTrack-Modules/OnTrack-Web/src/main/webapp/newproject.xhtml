<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">	
	
	<f:view>
	<ui:composition template="/template.xhtml">
				<ui:define name="body">
						<rich:panel header="#{msg.newproject}">
								
							<h:form>
						
								<h:panelGrid columns="2" cellspacing="2">
									<h:outputText value="#{msg.name}"/>
									<h:inputText value="#{newprojectctrl.project.name}" />	
								</h:panelGrid>
								
						<rich:tabPanel switchType="ajax">
				        		<rich:tab header="#{msg.persons}">
									<rich:panel style="width:560px;">
										<f:facet name="header">
							                <h:outputText value="#{msg.persons}"></h:outputText>
							            </f:facet>
										<rich:pickList value="#{membersctrl.selectedMembers}" var="member" listHeight="200px">
							                <f:selectItems value="#{membersctrl.contactsFromUser()}" />
							                <rich:column>
							                    <f:facet name="header">
							                    	<h:outputText value="#{msg.photo}"/> 
							                    </f:facet>
							                    <h:graphicImage value="http://google.com/images/logo.gif" alt="flag" width="33"/>
							                </rich:column>
							                <rich:column>
							                    <f:facet name="header"><h:outputText value="#{msg.name}"/></f:facet>
							                    <h:outputText id="namecolumn" value="#{member.name}"/>
							                    <rich:tooltip for="namecolumn"><h:outputText value="#{msg.email}"/></rich:tooltip> 
							                </rich:column>
							                <rich:column>
							                    <f:facet name="header"><h:outputText value="#{msg.email}"/></f:facet>
							                    <h:outputText value="#{member.email}"/>
							                </rich:column>
							            </rich:pickList>
						           
						           		<a4j:commandButton value="#{msg.sendmails}" action="#{membersctrl.notifySelectedMembers()}" execute="@form"/>
						           
									</rich:panel>
									
									
									
									

									
								 </rich:tab>
								 
								<rich:tab header="#{msg.issueconfiguration}">
								
								
									<rich:panel header="#{msg.issuestypes}">
										<h:panelGrid columns="2">
											<h:panelGrid columns="2">
												<h:form id="typeform">
													<h:outputText value="#{msg.issuestypes}" />
													<h:inputText id="descType" value="#{newprojectctrl.currentIssueType.description}" />
													<a4j:commandButton value="#{msg.save}" action="#{newprojectctrl.saveIssueType()}" execute="@form" render="typeform,typestable,propertypanelid">
														<a4j:ajax event="complete" render="typeform"/>
													</a4j:commandButton>
												</h:form>
											</h:panelGrid>
												
												<h:form>
												<rich:dataTable id="typestable" value="#{newprojectctrl.createdIssuesTypes}" var="item" >
													<rich:column>
														<f:facet name="header">
															<h:outputText value="#{msg.issuetype}"/>
														</f:facet>
														<h:outputText value="#{item.description}"/>
													</rich:column>
													<rich:column>
														<f:facet name="header">
															<h:outputText value="#{msg.assignproperty}"/>
														</f:facet>
														<a4j:commandButton value="#{msg.remove}" action="#{newprojectctrl.removeIssueType(item)}" render="typestable" execute="@form">
															
														</a4j:commandButton>
													</rich:column>
												</rich:dataTable>
												</h:form>
											
											<rich:dataScroller for="typestable" maxPages="5" renderIfSinglePage="false"/>
											
										</h:panelGrid>
									</rich:panel>
									
									<a4j:outputPanel id="propertypanelid">
										<rich:panel header="#{msg.propertytypes}">
											<h:form>
											<h:panelGrid columns="2">
												<h:outputText value="#{msg.issuetype}" />
												<h:selectOneMenu id="selecttype" defaultLabel="#{msg.selectatype}" value="#{newprojectctrl.currentIssueType}"> 	 
														<f:selectItems value="#{newprojectctrl.selectCreatedIssueTypes()}"/>
												</h:selectOneMenu>
												<h:outputText value="#{msg.propertyname}" />
												<h:inputText value="#{newprojectctrl.currentIssueProperty.description}"/>
												<h:outputText value="#{msg.propertytype}"/>
												<h:selectOneMenu defaultLabel="#{msg.selectatype}"  value="#{newprojectctrl.currentIssuePropertyType}" converter="#{newprojectctrl.propertyConverter()}">
													<f:selectItems value="#{newprojectctrl.allTypes}"/>
												</h:selectOneMenu>
												
												<a4j:commandButton action="#{newprojectctrl.saveProperty()}" value="#{msg.add}" render="propertypanelid" execute="@form"/>

												</h:panelGrid>
											</h:form>
											
											<h:form>
											<rich:dataTable id="propertytypestable" value="#{newprojectctrl.propertyTypes}" var="item" >
												<f:facet name="header">
													<h:outputText value="#{msg.propertytypes}"/>
												</f:facet>
												<h:column>
													<f:facet name="header">
														<h:outputText value="#{msg.propertyname}"/>
													</f:facet>
													<h:outputText value="#{item.description}"/>
												</h:column>
												<h:column>
													<f:facet name="header">
														<h:outputText value="#{msg.propertytype}"/>
													</f:facet>
													<h:outputText value="#{item.type.name}" />
												</h:column>
												<h:column>
													<f:facet name="header">
														<h:outputText value="#{msg.actions}"/>
													</f:facet>
													<a4j:commandButton action="#{newprojectctrl.removePropertyType}" value="#{msg.remove}" execute="@form" render="propertytypestable"/>												
												</h:column>
											</rich:dataTable>
											</h:form>
											
										</rich:panel>
										
										<rich:panel header="#{msg.workflow}">
											<h:form>
												<h:panelGrid columns="1">
													<h:selectOneMenu defaultLabel="#{msg.selectatype}"  
																 value="#{newprojectctrl.currentIssueType}" 
																 converter="#{newprojectctrl.propertyConverter()}">
														<f:selectItems value="#{newprojectctrl.createdIssuesTypes}"/>
														<a4j:ajax event="change" render="workflowpanel"/>
													</h:selectOneMenu>
																									
													<rich:panel id="workflowpanel" header="#{msg.workflow}" rendered="#{newprojectctrl.currentIssueType !=null and newprojectctrl.currentIssueType.description != null}">
														<rich:orderingList value="#{newprojectctrl.allIssueStatus}" var="item" itemValue="#{item}" itemLabel="#{item.description}"/>
													</rich:panel>													
												</h:panelGrid>												
											</h:form>
										</rich:panel>	
										
									</a4j:outputPanel>
										
									</rich:tab>
									
												
									</rich:tabPanel>
								
								
								<h:commandButton value="#{msg.createproject}" action="#{newprojectctrl.createProject()}" />
						</h:form>								
						
						
						</rich:panel>
						
						
				</ui:define>
	</ui:composition>	
	</f:view>

		
	
</ui:composition>